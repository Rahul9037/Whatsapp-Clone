{"ast":null,"code":"import _slicedToArray from\"/Users/rahulsmac/Documents/reactapp/whatsapp-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./Chat.css';import{Avatar,IconButton}from'@material-ui/core';import AttachFileIcon from'@material-ui/icons/AttachFile';import MoreVertIcon from'@material-ui/icons/MoreVert';import SearchIcon from'@material-ui/icons/Search';import EmojiEmotionsIcon from'@material-ui/icons/EmojiEmotions';import MicIcon from'@material-ui/icons/Mic';import{useParams}from'react-router-dom';import{useStateValue}from'../../contextAPI/StateProvider';import firebase from\"firebase\";import db from'../../firebase';function Chat(){var _messages,_messages$timestamp;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),roomName=_useState4[0],setRoomName=_useState4[1];var _useParams=useParams(),roomId=_useParams.roomId;var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),seed=_useState6[0],setSeed=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useStateValue=useStateValue(),_useStateValue2=_slicedToArray(_useStateValue,2),user=_useStateValue2[0].user,dispatch=_useStateValue2[1];useEffect(function(){setSeed(Math.floor(Math.random()*5000));},[roomId]);useEffect(function(){if(roomId){db.collection('rooms').doc(roomId).onSnapshot(function(snapShot){return setRoomName(snapShot.data().name);});db.collection('rooms').doc(roomId).collection('messages').orderBy('timestamp','asc').onSnapshot(function(snapShot){return setMessages(snapShot.docs.map(function(doc){return doc.data();}));});}},[roomId]);var sendMessage=function sendMessage(e){e.preventDefault();//to sent message\ndb.collection('rooms').doc(roomId).collection('messages').add({message:input,name:user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setInput('');};return/*#__PURE__*/React.createElement(\"div\",{className:\"chat\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat__header\"},/*#__PURE__*/React.createElement(Avatar,{src:\"https://avatars.dicebear.com/api/human/\".concat(seed,\".svg\")}),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__headerInfo\"},/*#__PURE__*/React.createElement(\"h3\",null,roomName),messages.length>0?/*#__PURE__*/React.createElement(\"p\",null,\"Last message at\",\" \",new Date((_messages=messages[messages.length-1])===null||_messages===void 0?void 0:(_messages$timestamp=_messages.timestamp)===null||_messages$timestamp===void 0?void 0:_messages$timestamp.toDate()).toUTCString()):null),/*#__PURE__*/React.createElement(\"div\",{className:\"chat_headerRight\"},/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(SearchIcon,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(AttachFileIcon,null)),/*#__PURE__*/React.createElement(IconButton,null,/*#__PURE__*/React.createElement(MoreVertIcon,null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__body\"},messages.map(function(message){var _message$timestamp;return/*#__PURE__*/React.createElement(\"p\",{key:message,className:\"chat__message \".concat(message.name===user.displayName&&\"chat__reciever\")},/*#__PURE__*/React.createElement(\"span\",{className:\"chat__name\"},message.name),message.message,/*#__PURE__*/React.createElement(\"span\",{className:\"chat__timestamp\"},new Date((_message$timestamp=message.timestamp)===null||_message$timestamp===void 0?void 0:_message$timestamp.toDate()).toUTCString()));})),/*#__PURE__*/React.createElement(\"div\",{className:\"chat__footer\"},/*#__PURE__*/React.createElement(EmojiEmotionsIcon,null),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"input\",{onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message\",type:\"text\",value:input}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",onClick:sendMessage},\"Sent Message\")),/*#__PURE__*/React.createElement(MicIcon,null)));}export default Chat;","map":{"version":3,"sources":["/Users/rahulsmac/Documents/reactapp/whatsapp-clone/src/components/Chat/Chat.js"],"names":["React","useState","useEffect","Avatar","IconButton","AttachFileIcon","MoreVertIcon","SearchIcon","EmojiEmotionsIcon","MicIcon","useParams","useStateValue","firebase","db","Chat","input","setInput","roomName","setRoomName","roomId","seed","setSeed","messages","setMessages","user","dispatch","Math","floor","random","collection","doc","onSnapshot","snapShot","data","name","orderBy","docs","map","sendMessage","e","preventDefault","add","message","displayName","timestamp","firestore","FieldValue","serverTimestamp","length","Date","toDate","toUTCString","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './Chat.css';\nimport { Avatar, IconButton } from '@material-ui/core';\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport SearchIcon from '@material-ui/icons/Search';\nimport EmojiEmotionsIcon from '@material-ui/icons/EmojiEmotions';\nimport MicIcon from '@material-ui/icons/Mic';\nimport { useParams } from 'react-router-dom';\nimport { useStateValue } from '../../contextAPI/StateProvider';\nimport firebase from \"firebase\";\nimport db from '../../firebase';\n\nfunction Chat() {\n\n    const [input, setInput] = useState('');\n    const [roomName, setRoomName] = useState('');\n    const { roomId } = useParams();\n    const [seed, setSeed] = useState('');\n    const [messages, setMessages] = useState([]);\n    const [{user} , dispatch] = useStateValue();\n\n    useEffect(() => {\n        setSeed(Math.floor(Math.random() * 5000));\n    }, [roomId])\n\n    useEffect(() => {\n        if (roomId) {\n            db.collection('rooms').doc(roomId)\n                .onSnapshot(\n                    snapShot => (setRoomName(snapShot.data().name))\n                )\n            db.collection('rooms').doc(roomId).collection('messages')\n                .orderBy('timestamp', 'asc').onSnapshot(\n                    snapShot => (setMessages(snapShot.docs.map\n                        (doc => doc.data())\n                    )))\n        }\n    }, [roomId])\n\n    const sendMessage = (e) => {\n        e.preventDefault();\n        //to sent message\n        db.collection('rooms').doc(roomId)\n        .collection('messages').add({\n            message : input,\n            name: user.displayName,\n            timestamp : firebase.firestore.FieldValue.serverTimestamp(),\n        })\n        setInput('');\n    }\n    return (\n        <div className=\"chat\">\n            <div className=\"chat__header\">\n                <Avatar src={`https://avatars.dicebear.com/api/human/${seed}.svg`} />\n                <div className=\"chat__headerInfo\">\n                    <h3>{roomName}</h3>\n                    {messages.length > 0 ? (<p>Last message at{\" \"}\n                        {new Date( messages[messages.length - 1]?.timestamp?.toDate()).toUTCString()}\n                    </p>) : null}\n                </div>\n                <div className=\"chat_headerRight\">\n                    <IconButton>\n                        <SearchIcon />\n                    </IconButton>\n                    <IconButton>\n                        <AttachFileIcon />\n                    </IconButton>\n                    <IconButton>\n                        <MoreVertIcon />\n                    </IconButton>\n                </div>\n            </div>\n            <div className=\"chat__body\">\n                {messages.map(message => \n                    (<p key={message} className={`chat__message ${message.name === user.displayName && `chat__reciever`}`}>\n                        <span className=\"chat__name\">{message.name}</span>\n                            {message.message}\n                        <span className=\"chat__timestamp\">\n                            {\n                                new Date(message.timestamp?.toDate()).toUTCString()\n                            }\n                        </span>\n                    </p>))}\n\n            </div>\n            <div className=\"chat__footer\">\n                <EmojiEmotionsIcon />\n                <form>\n                    <input onChange={(e) => setInput(e.target.value)} placeholder=\"Type a message\" type=\"text\" value={input} />\n                    <button type=\"submit\" onClick={sendMessage}>Sent Message</button>\n                </form>\n                <MicIcon />\n            </div>\n        </div>\n    )\n}\n\nexport default Chat\n"]},"metadata":{},"sourceType":"module"}